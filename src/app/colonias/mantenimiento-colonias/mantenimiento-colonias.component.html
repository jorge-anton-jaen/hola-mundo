<div class="contenedor-colonias">
  <h1>Mantenimiento de Colonias</h1>
  <p>Administra las colonias y sus gatos asociados.</p>
  <div class="filtro-colonias">
    <div class="mb-3">
      <label class="form-label">Buscar por localización</label>
      <input type="text" class="form-control" [(ngModel)]="filtroLocalizacion" (input)="filtrar()" placeholder="Localización">
    </div>
    <button class="btn btn-primary" (click)="abrirDialogoNuevaColonia()">
      <i class="bi bi-plus"></i>
      Añadir Colonia
    </button>
  </div>

  <table class="table table-striped table-bordered">
    <thead>
      <tr>
        <th>Localización</th>
        <th>Gatos</th>
        <th>Inicio</th>
        <th>Revisión</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      @for (colonia of coloniasFiltradas; track colonia) {
        <tr>
          <td>{{ colonia.localizacion }}</td>
          <td>
            @for (gato of colonia.gatos; track gato; let last = $last) {
              <span>
                {{ gato.nombre }}@if (!last) {
                <span>, </span>
              }
            </span>
          }
        </td>
        <td>{{ colonia.fechaInicio | date }}</td>
        <td>{{ colonia.fechaRevision | date }}</td>
        <td>
          <button class="btn btn-sm btn-outline-primary me-1" (click)="editarColonia(colonia)">
            <i class="bi bi-pencil"></i>
          </button>
          <button class="btn btn-sm btn-outline-danger" (click)="eliminarColonia(colonia)">
            <i class="bi bi-trash"></i>
          </button>
        </td>
      </tr>
    }
  </tbody>
</table>

@if (mostrarFormularioColonia) {
  <app-formulario-colonia
    [colonia]="coloniaEditando"
    (guardar)="guardarColonia($event)"
    (cancelar)="cerrarFormularioColonia()">
  </app-formulario-colonia>
}
</div>
