<div class="contenedor-capturas">
  <h1>Mantenimiento de Capturas</h1>
  <p>Administra las capturas de gatos en colonias.</p>
  <div class="filtro-capturas">
    <div class="mb-3">
      <label class="form-label">Buscar por fecha</label>
      <input type="date" class="form-control" [(ngModel)]="filtroFecha" (change)="filtrar()">
    </div>
    <div class="mb-3">
      <label class="form-label">Buscar por gato</label>
      <input type="text" class="form-control" [(ngModel)]="filtroGato" (input)="filtrar()" placeholder="Nombre del gato">
    </div>
    <button class="btn btn-primary" (click)="abrirDialogoNuevaCaptura()">
      <i class="bi bi-plus"></i>
      AÃ±adir Captura
    </button>
  </div>

  <table class="table table-striped table-bordered">
    <thead>
      <tr>
        <th>Gatos</th>
        <th>Fecha de Captura</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      @for (captura of capturasFiltradas; track captura) {
        <tr>
          <td>
            @for (gato of captura.gatos; track gato; let last = $last) {
              <span>
                {{ gato.nombre }}@if (!last) {
                <span>, </span>
              }
            </span>
          }
        </td>
        <td>{{ captura.fechaCaptura | date }}</td>
        <td>
          <button class="btn btn-sm btn-outline-primary me-1" (click)="editarCaptura(captura)">
            <i class="bi bi-pencil"></i>
          </button>
          <button class="btn btn-sm btn-outline-danger" (click)="eliminarCaptura(captura)">
            <i class="bi bi-trash"></i>
          </button>
        </td>
      </tr>
    }
  </tbody>
</table>

@if (mostrarFormularioCaptura) {
  <app-formulario-captura
    [captura]="capturaEditando"
    (guardar)="guardarCaptura($event)"
    (cancelar)="cerrarFormularioCaptura()">
  </app-formulario-captura>
}
</div>